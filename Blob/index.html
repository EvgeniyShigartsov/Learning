<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <div class="box">
            <a download="hello.txt" href="#" id="link">Загрузить</a>
            <img src="data:image/png;base64,R0lGODlhDAAMAKIFAF5LAP/zxAAAANyuAP/gaP///wAAAAAAACH5BAEAAAUALAAAAAAMAAwAAAMlWLPcGjDKFYi9lxKBOaGcF35DhWHamZUW0K4mAbiwWtuf0uxFAgA7" />
        </div>

        <script>
            const box = document.querySelector('.box ')
            const DOMAIN = 'http://api.aviationstack.com/v1/airports?access_key=79d0c72f8c324728513229dae07d80d2&limit=6472'
            const link = document.querySelector('#link')
            // const blob = new Blob(['Hello, world!'], { type: 'text/plain' })

            // const href = URL.createObjectURL(blob)
            // link.href = href

            const getAirports = async () => {
                const res = await fetch(DOMAIN)
                const data = await res.json()

                const jsonString = JSON.stringify(data)
                const blob = new Blob([jsonString], { type: 'text/plain' })
                const href = URL.createObjectURL(blob)
                link.href = href
                box.insertAdjacentHTML('beforeend', `<div>Данные загружены</div>`)

                return data
            }
            // getAirports()
            // URL.revokeObjectURL(link.href);
        </script>
        <script src="./index.js" type="module"></script>
    </body>
</html>
